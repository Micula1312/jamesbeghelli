*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%}
body{
  min-height:100vh;background:#000;overflow:hidden;cursor:default;
  font-family:"MS Sans Serif","Tahoma",Verdana,Arial,sans-serif;
}

/* ===== Desktop background ===== */
#desktop{
  background:url('img/wallpapers/tile.png') repeat;
  image-rendering:pixelated;
}

#fx-layer{ position:fixed; z-index:9999999; inset:0; overflow:visible; pointer-events:none; }

/* ===== Cornice browser ’90s ===== */
.browser{
  position:fixed; /* importante per il drag */
  z-index:8;
  width:min(92vw,1100px);
  height:min(78vh,760px);
  left:0; top:0; /* verrà centrata da JS */
  margin:0;
  background:#c0c0c0;
  border:2px solid; border-color:#fff #404040 #404040 #fff; border-radius:6px;
  box-shadow:inset 1px 1px 0 #fff,inset -1px -1px 0 #9a9a9a,0 8px 24px rgba(0,0,0,.45);
}

/* ===== Titlebar ===== */
.titlebar{ cursor:grab }
.titlebar.dragging{ cursor:grabbing }
.browser.dragging{ user-select:none }

/* layout base */
.titlebar{
  display:flex; align-items:center; gap:8px; padding:6px 8px;
  background:linear-gradient(#00008b,#1e3a8a); color:#fff; font-weight:700;
  user-select:none; border-radius:6px 6px 0 0;
}

/* FIX: ellissi robusta nel viewer */
.browser .titlebar > *{ min-width:0; }             /* necessario per ellissi nei flex */
.browser .titlebar .tb-controls{ flex:0 0 auto; margin-left:auto; }
.browser .titlebar .caption,
.browser .titlebar [data-title],
.browser .titlebar .tb-title{
  flex:1 1 auto; min-width:0;
  overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
}

/* pulsanti finestra */
.tb-controls{ flex:0 0 auto; display:flex; gap:6px }
.tb-btn{
  width:16px;height:16px;background:#c0c0c0;border:2px solid;
  border-color:#fff #404040 #404040 #fff;border-radius:2px;
  box-shadow:inset 1px 1px 0 #fff,inset -1px -1px 0 #9a9a9a
}

/* ===== Menubar & Toolbar ===== */
.menubar{
  display:flex;gap:16px;padding:6px 8px;background:#dcdcdc;
  border-top:1px solid #fff;border-bottom:1px solid #9a9a9a;font-size:13px;user-select:none;
}
.toolbar{
  display:flex;align-items:center;gap:8px;padding:6px 8px;background:#c8c8c8;border-bottom:2px solid #9a9a9a;
}
.tool-btn{
  padding:2px 8px;background:#dcdcdc;border:2px solid;
  border-color:#fff #404040 #404040 #fff;border-radius:3px;font-size:13px;user-select:none;cursor:pointer;
}
.addr{
  flex:1;display:flex;align-items:center;gap:6px;margin-left:8px;padding:2px 6px;background:#fff;
  border:2px inset #9a9a9a;border-radius:2px;font-family:"Courier New",monospace;font-size:13px
}
.addr .scheme{color:#005a00}.addr .host{color:#000}

/* FIX: su mobile togli l’address bar per dare spazio al titolo */
@media (max-width:560px){
  .toolbar .addr{ display:none; }
}

/* ===== Viewport (immagine + crumble) ===== */
.content{position:relative;height:calc(100% - 92px);background:#808080;padding:8px}
.viewport{
  position:relative;width:100%;height:100%;border:2px inset #9a9a9a;border-radius:2px;overflow:hidden;
  background:#000; /* barre nere se object-fit: contain */
  image-rendering:pixelated;
}
#vpImg{
  position:absolute;left:0;top:0;width:100%;height:100%;
  object-fit:contain; /* <-- niente deformazione */
  object-position:center center;user-select:none;pointer-events:none;
}
h1.brand{
  position:absolute;z-index:2;left:12px;top:12px;color:#fff;font-size:20px;
  text-shadow:0 1px 0 #000;user-select:none;pointer-events:none;
}

/* Crumble overlay dentro il viewport */
.crumble{position:absolute;inset:0;z-index:3;pointer-events:none}
.crumb{position:absolute;will-change:transform;background-repeat:no-repeat;image-rendering:pixelated}

/* Colonna stile Netscape (log) */
.side-column{
  position:fixed;right:16px;bottom:92px;z-index:5;width:min(32vw,320px);
  max-height:min(44vh,340px);overflow:auto;background:#c0c0c0;color:#000;
  border:2px solid;border-color:#fff #404040 #404040 #fff;border-radius:4px;
  box-shadow:inset 1px 1px 0 #fff,inset -1px -1px 0 #9a9a9a,1px 1px 0 #000;
}
.side-header{padding:6px 8px;background:#dcdcdc;border-bottom:1px solid #9a9a9a;font-weight:700;user-select:none}
.side-body{padding:8px;font-family:"Courier New",monospace;font-size:13px;line-height:1.35;white-space:pre-wrap}
.line::before{content:"› ";color:#005a00;font-weight:bold}

/* Dock pulsanti ’90s (in basso a destra) */
.action-dock{position:fixed;right:16px;bottom:16px;display:flex;gap:10px;z-index:9999; pointer-events: auto;}
.win95-btn{
  min-width:110px;padding:10px 18px;font-weight:700;font-size:14px;color:#000;background:#c0c0c0;
  border:2px solid;border-color:#fff #404040 #404040 #fff;border-radius:4px;
  box-shadow:inset 1px 1px 0 #fff,inset -1px -1px 0 #9a9a9a,1px 1px 0 #000;
  image-rendering:pixelated;cursor:pointer;user-select:none;
}
.win95-btn:hover{background:#d6d6d6}
.win95-btn:active{border-color:#404040 #fff #fff #404040;box-shadow:inset 1px 1px 0 #9a9a9a,inset -1px -1px 0 #fff;transform:translateY(1px)}
.win95-btn .emoji{margin-right:6px}

/* Toast ’90s */
.toast{
  position:fixed;right:16px;bottom:148px;z-index:7;min-width:220px;padding:10px 14px;background:#c0c0c0;color:#000;font-size:14px;
  border:2px solid;border-color:#fff #404040 #404040 #fff;border-radius:4px;
  box-shadow:inset 1px 1px 0 #fff,inset -1px -1px 0 #9a9a9a,1px 1px 0 #000;
  display:flex;align-items:center;gap:8px;animation:toast-in .12s steps(4,end) both;
}
.toast .led{width:10px;height:10px;border-radius:2px;background:#1aff00;box-shadow:0 0 6px #1aff00 inset}
@keyframes toast-in{from{transform:translateY(6px)}to{transform:translateY(0)}}
@keyframes toast-out{to{transform:translateY(6px)}}

/* Comete */
.comet{ pointer-events:none; will-change:transform; contain:layout paint; }
.comet img{ image-rendering:pixelated; }
.tail{
  position:absolute;left:50%;top:50%;width:180px;height:8px;transform-origin:100% 50%;transform:translate(-100%,-50%);
  background:repeating-linear-gradient(90deg,rgba(255,255,255,.85) 0 6px,rgba(255,255,255,.25) 6px 12px,transparent 12px 18px);
  filter:blur(1px);mix-blend-mode:screen;border-radius:999px;
}

/* ===== Desktop con icone ===== */
.desktop{
  position:fixed; inset:0; z-index:2;
  background:transparent; /* lascia il tuo sfondo sotto */
  display:grid; grid-template-columns:repeat(auto-fill,90px);
  grid-auto-rows:90px; gap:8px; align-content:start; padding:14px;
  user-select:none;
}
.icon{
  width:90px; height:90px; display:flex; flex-direction:column; align-items:center; justify-content:center;
  border:2px solid transparent; border-radius:6px; padding:4px;
}
.icon:hover{ background:rgba(255,255,255,0.06); }
.icon.selected{ border-color:#fff; background:rgba(255,255,255,0.12); }
.icon img{ width:48px; height:48px; image-rendering:pixelated; }
.icon .label{ margin-top:6px; font-size:12px; color:#fff; text-align:center; text-shadow:0 1px 0 #000; }
.icon img.folder-icon { width:56px; height:56px; }

/* ===== Finestra progetto ===== */
.win{
  position:fixed; z-index:10; width:min(70vw,900px); height:min(65vh,620px);
  left:20px; top:20px; background:#c0c0c0;
  border:2px solid; border-color:#fff #404040 #404040 #fff; border-radius:6px;
  box-shadow:inset 1px 1px 0 #fff, inset -1px -1px 0 #9a9a9a, 0 8px 24px rgba(0,0,0,.45);
}
.win .content{ position:relative; height:calc(100% - 92px); background:#808080; padding:8px; }
.win .viewport{ position:relative; width:100%; height:100%; border:2px inset #9a9a9a; background:#000; overflow:hidden; }
.win .vpImg, .win [data-img]{ position:absolute; inset:0; width:100%; height:100%; object-fit:contain; object-position:center; }

/* Titolo attivo/inattivo */
.win.active .titlebar{ filter:none; }
.win .titlebar{ cursor:grab; filter:grayscale(.2) brightness(.95); }

/* ==== Titlebar finestre: niente sbordi ==== */
.win .titlebar{ display:flex; align-items:center; gap:6px; }
.win .titlebar .tb-controls{ flex:0 0 auto; }
.win .titlebar .addr{ flex:1 1 auto; min-width:0; display:flex; gap:6px; align-items:center; overflow:hidden; }
.win .titlebar .addr > *{ min-width:0; }
.win .titlebar [data-title],
.win .titlebar [data-slug]{
  overflow:hidden; text-overflow:ellipsis; white-space:nowrap; max-width:100%;
}

/* su mobile lascia solo lo slug (o viceversa) */
@media (max-width:480px){
  .win .titlebar [data-title]{ display:none; }
}

/* Corpo finestra: testi lunghi */
.win [data-desc]{ overflow-wrap:anywhere; word-break:break-word; }

/* Etichette icone più elastiche */
.icon .label{ max-width:96px; overflow-wrap:anywhere; text-align:center; }

/* === Icona "X" stile ’90s === */
.tb-btn{ position:relative; display:inline-flex; align-items:center; justify-content:center; }
.tb-btn[data-action="close"]::before,
.tb-btn[data-action="close"]::after{
  content:"";
  position:absolute;
  width:12px; height:2px; background:#000; image-rendering:pixelated; transform-origin:center;
}
.tb-btn[data-action="close"]::before{ transform:rotate(45deg); }
.tb-btn[data-action="close"]::after { transform:rotate(-45deg); }
.tb-btn[data-action="close"]:hover{ background:#e6caca; }
.tb-btn[data-action="close"]:active{
  border-color:#404040 #fff #fff #404040;
  box-shadow:inset 1px 1px 0 #9a9a9a, inset -1px -1px 0 #fff;
  transform:translateY(1px);
}

/* ===== Bio window ===== */
.bio-body{
  position:absolute; inset:12px; overflow:auto;
  background:#000; color:#d7ffd7; /* CRT vibes */
  font-family:"Courier New",monospace; font-size:14px; line-height:1.5;
  white-space:pre-wrap;
}
